<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.solarnetwork.central.datum.dao.mybatis.GeneralNodeDatum">

	<select id="findall-GeneralNodeDatum-ReportingGeneralNodeDatum-Year-count" resultType="long">
		<include refid="fragment-findall-ReportingGeneralNodeDatum-combine-cte"/>
		SELECT count(datum.ts_start)
		FROM (
			<include refid="fragment-findall-ReportingGeneralNodeDatum-time-rounded-datum-agg">
				<property name="date_field" value="year" />
				<property name="date_field_agg" value="year" />
			</include>
		) datum
		<include refid="fragment-findall-ReportingGeneralNodeDatum-combine-join"/>
		<include refid="fragment-findall-ReportingGeneralNodeDatum-combine-group"/>
	</select>
	
	<select id="findall-GeneralNodeDatum-ReportingGeneralNodeDatum-Year" resultMap="ReportingGeneralNodeDatumMatchResult" fetchSize="250" resultSetType="FORWARD_ONLY">
		<include refid="fragment-findall-ReportingGeneralNodeDatum-combine-cte"/>
		SELECT
			<include refid="fragment-GeneralNodeDatum-aggregation-result"/>
		FROM (
			<include refid="fragment-findall-ReportingGeneralNodeDatum-time-rounded-datum-agg">
				<property name="date_field" value="year" />
				<property name="date_field_agg" value="year" />
			</include>
		) datum
		<include refid="fragment-findall-ReportingGeneralNodeDatum-combine-join"/>
		<include refid="fragment-findall-ReportingGeneralNodeDatum-combine-group"/>
		<include refid="fragment-findall-ReportingGeneralNodeDatum-order"/>
	</select>

</mapper>
